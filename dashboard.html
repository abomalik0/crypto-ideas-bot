<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8" />
    <title>IN CRYPTO Ai â€” WAR ROOM</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800&display=swap');

        :root {
            --bg-main: #020617;
            --bg-main-grad: radial-gradient(circle at top, #111827 0, #020617 55%);
            --bg-card: #050814;
            --bg-card-soft: #060919;
            --border-soft: rgba(148, 163, 184, 0.28);
            --accent-yellow: #fcd34d;
            --accent-yellow-soft: rgba(252, 211, 77, 0.16);
            --accent-green: #22c55e;
            --accent-red: #f97373;
            --accent-blue: #38bdf8;
            --text-main: #f9fafb;
            --text-muted: #9ca3af;
        }

        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: "Cairo", system-ui, sans-serif;
            background:
                radial-gradient(circle at top left, rgba(248, 250, 252, 0.05), transparent 55%),
                radial-gradient(circle at top right, rgba(252, 211, 77, 0.12), transparent 55%),
                var(--bg-main-grad);
            color: var(--text-main);
            min-height: 100vh;
        }

        /* ===== TOP BTC BAR (Binance-style ticker) ===== */
        .top-ticker {
            width: 100%;
            padding: 8px 16px;
            background: linear-gradient(90deg, #020617, #040713);
            border-bottom: 1px solid rgba(148, 163, 184, 0.25);
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            align-items: center;
            justify-content: space-between;
            font-size: 13px;
        }

        .ticker-left {
            display: flex;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
        }

        .mode-pill {
            padding: 3px 10px;
            border-radius: 999px;
            background: #020617;
            border: 1px solid rgba(148, 163, 184, 0.6);
            font-size: 10px;
            letter-spacing: 0.12em;
            text-transform: uppercase;
            color: var(--text-muted);
        }

        .mode-pill span {
            color: var(--accent-yellow);
        }

        .ticker-pair {
            font-size: 12px;
            color: var(--text-muted);
        }

        .ticker-right {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            align-items: center;
        }

        .ticker-metric {
            display: flex;
            gap: 4px;
            align-items: baseline;
            font-size: 12px;
        }

        .ticker-label {
            color: var(--text-muted);
        }

        .ticker-value {
            font-weight: 600;
        }

        .up { color: var(--accent-green); }
        .down { color: var(--accent-red); }

        /* ===== HEADER ===== */
        .header {
            padding: 14px 18px 8px;
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            gap: 12px;
        }

        .header-main {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .header-title {
            font-size: 21px;
            font-weight: 800;
            letter-spacing: 0.18em;
            text-transform: uppercase;
            color: var(--accent-yellow);
        }

        .header-sub {
            font-size: 12px;
            color: var(--text-muted);
        }

        .header-sub b {
            color: #e5e7eb;
        }

        .header-badges {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            align-items: center;
        }

        .header-badge {
            font-size: 11px;
            padding: 4px 9px;
            border-radius: 999px;
            border: 1px solid rgba(148, 163, 184, 0.4);
            background: rgba(15, 23, 42, 0.9);
            color: var(--text-muted);
        }

        .header-badge strong {
            color: #fef3c7;
        }

        /* ===== GRID LAYOUT ===== */
        .grid {
            padding: 12px 18px 22px;
            display: grid;
            grid-template-columns: repeat(3, minmax(0, 1fr));
            gap: 14px;
        }

        @media (max-width: 1180px) {
            .grid {
                grid-template-columns: repeat(2, minmax(0, 1fr));
            }
        }

        @media (max-width: 820px) {
            .header {
                padding: 12px 10px 8px;
            }
            .top-ticker {
                padding: 8px 10px;
            }
            .grid {
                grid-template-columns: minmax(0, 1fr);
                padding: 10px 10px 18px;
            }
        }

        /* ===== CARD BASE ===== */
        .card {
            background: var(--bg-card);
            border-radius: 16px;
            border: 1px solid var(--border-soft);
            padding: 12px 12px 11px;
            position: relative;
            overflow: hidden;
            box-shadow:
                0 16px 32px rgba(0, 0, 0, 0.85),
                0 0 0 1px rgba(15, 23, 42, 0.8);
        }

        .card::before {
            content: "";
            position: absolute;
            inset: 0;
            background:
                radial-gradient(circle at top left, rgba(252, 211, 77, 0.12), transparent 55%);
            opacity: 0;
            transition: opacity 0.20s ease-out;
            pointer-events: none;
        }

        .card:hover::before {
            opacity: 1;
        }

        .card-header {
            display: flex;
            align-items: baseline;
            justify-content: space-between;
            margin-bottom: 6px;
            gap: 6px;
        }

        .card-title {
            font-size: 13px;
            font-weight: 700;
            color: #e5e7eb;
        }

        .card-tag {
            font-size: 10px;
            padding: 3px 7px;
            border-radius: 999px;
            border: 1px solid rgba(148, 163, 184, 0.4);
            color: var(--text-muted);
            background: var(--bg-card-soft);
        }

        .card-main {
            font-size: 20px;
            font-weight: 800;
            margin-top: 4px;
        }

        .card-main span.small {
            font-size: 11px;
            font-weight: 500;
            color: var(--text-muted);
        }

        .subtext {
            font-size: 11px;
            margin-top: 3px;
            color: var(--text-muted);
            line-height: 1.6;
        }

        .kpi-row {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-top: 8px;
        }

        .kpi-pill {
            padding: 4px 9px;
            border-radius: 999px;
            background: var(--bg-card-soft);
            border: 1px solid rgba(148, 163, 184, 0.35);
            font-size: 10px;
            display: inline-flex;
            gap: 4px;
            align-items: baseline;
        }

        .kpi-label {
            color: var(--text-muted);
        }

        .kpi-val {
            font-weight: 600;
        }

        .green { color: var(--accent-green); }
        .red   { color: var(--accent-red); }
        .yellow { color: var(--accent-yellow); }
        .blue  { color: var(--accent-blue); }

        /* ===== HEATBAR ===== */
        .heatbar {
            margin-top: 9px;
            width: 100%;
            height: 6px;
            border-radius: 999px;
            overflow: hidden;
            position: relative;
            background: linear-gradient(90deg,
                        #22c55e,
                        #eab308,
                        #f97316,
                        #ef4444);
        }

        .heatbar-track {
            position: absolute;
            inset: 0;
            background: linear-gradient(90deg,
                        rgba(34,197,94,0.08),
                        rgba(250,204,21,0.12),
                        rgba(248,250,252,0.05));
            mix-blend-mode: soft-light;
        }

        .heatbar-dot {
            position: absolute;
            top: 50%;
            width: 16px;
            height: 16px;
            border-radius: 999px;
            transform: translate(-50%, -50%);
            border: 2px solid #020617;
            box-shadow: 0 0 14px rgba(248, 250, 252, 0.9);
            background: #fef3c7;
        }

        .heatbar-labels {
            display: flex;
            justify-content: space-between;
            font-size: 9px;
            color: var(--text-muted);
            margin-top: 3px;
        }

        /* ===== LOG AREA ===== */
        pre {
            margin: 6px 0 0;
            padding: 7px;
            border-radius: 10px;
            background: #020617;
            border: 1px solid rgba(148, 163, 184, 0.35);
            font-size: 10px;
            max-height: 145px;
            overflow: auto;
            direction: ltr;
            text-align: left;
            white-space: pre-wrap;
        }

        /* ===== ALERT FLASH ===== */
        .flash {
            animation: flashAnim 0.9s infinite alternate;
        }

        @keyframes flashAnim {
            from {
                box-shadow: 0 0 18px rgba(252, 211, 77, 0.6);
                border-color: rgba(252, 211, 77, 0.9);
            }
            to {
                box-shadow: 0 0 26px rgba(248, 113, 113, 0.9);
                border-color: rgba(248, 113, 113, 0.95);
            }
        }

        /* ===== BUTTONS ===== */
        .btn-row {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-top: 8px;
        }

        button {
            border-radius: 999px;
            border: 0;
            padding: 5px 11px;
            font-size: 10px;
            cursor: pointer;
            background: #020617;
            color: #e5e7eb;
            border: 1px solid rgba(148, 163, 184, 0.7);
        }

        button.primary {
            background: radial-gradient(circle at top,
                        #fbbf24,
                        #f59e0b);
            color: #111827;
            font-weight: 700;
            border-color: transparent;
        }

        button.secondary {
            border-style: dashed;
        }

        /* ===== ALERTS LIST ===== */
        .alerts-list {
            margin-top: 3px;
            font-size: 10px;
            max-height: 140px;
            overflow: auto;
            line-height: 1.5;
        }

        .alert-item {
            margin-bottom: 3px;
        }

        /* ===== FOOTER ===== */
        .footer {
            padding: 4px 0 10px;
            font-size: 10px;
            text-align: center;
            color: var(--text-muted);
        }

        .footer span {
            color: var(--accent-yellow);
        }
    </style>
</head>

<body>

    <!-- ========== TOP BTC BAR ========== -->
    <div class="top-ticker" id="btcBar">
        <div class="ticker-left">
            <div class="mode-pill">
                WAR ROOM â€¢ <span>ØºØ±ÙØ© Ø¹Ù…Ù„ÙŠØ§Øª IN CRYPTO</span>
            </div>
            <div class="ticker-pair">BTCUSDT â€¢ Live Snapshot</div>
        </div>
        <div class="ticker-right">
            <div class="ticker-metric">
                <span class="ticker-label">Ø§Ù„Ø³Ø¹Ø±:</span>
                <span class="ticker-value" id="barPrice">-</span>
            </div>
            <div class="ticker-metric">
                <span class="ticker-label">ØªØºÙŠØ± 24 Ø³:</span>
                <span class="ticker-value" id="barChange">-</span>
            </div>
            <div class="ticker-metric">
                <span class="ticker-label">Ù…Ø¯Ù‰ Ø§Ù„ÙŠÙˆÙ…:</span>
                <span class="ticker-value" id="barRange">-</span>
            </div>
            <div class="ticker-metric">
                <span class="ticker-label">ÙˆØ¶Ø¹ Ø§Ù„Ø³ÙˆÙ‚:</span>
                <span class="ticker-value" id="badgeMode">-</span>
            </div>
        </div>
    </div>

    <!-- ========== HEADER ========== -->
    <div class="header">
        <div class="header-main">
            <div class="header-title">IN CRYPTO â€” WAR ROOM</div>
            <div class="header-sub">
                Ù„ÙˆØ­Ø© Ù…Ø±Ø§Ù‚Ø¨Ø© Ø°ÙƒÙŠØ© Ù…Ø¨Ù†ÙŠØ© Ø¹Ù„Ù‰ <b>Ø­Ø±ÙƒØ© Ø§Ù„Ø¨ÙŠØªÙƒÙˆÙŠÙ† ÙÙ‚Ø·</b>ØŒ ØªØ¯Ù…Ø¬ Ù‚ÙˆØ© Ø§Ù„Ø³ÙˆÙ‚ØŒ Ø§Ù„Ù…Ø®Ø§Ø·Ø±ØŒ
                Ø§Ù„Ø³ÙŠÙˆÙ„Ø©ØŒ Ø§Ù„ØªÙ‚Ù„Ø¨Ø§ØªØŒ ÙˆØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ­Ø°ÙŠØ±Ø§Øª Ù„ØµÙ†Ø§Ø¹Ø© Ù‚Ø±Ø§Ø±Ø§Øª ØªØ¯Ø§ÙˆÙ„ Ù…Ù†Ø¸Ù…Ø©.
            </div>
        </div>
        <div class="header-badges">
            <div class="header-badge">
                Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ« Real-Time: <strong id="badgeRealtime">---</strong>
            </div>
            <div class="header-badge">
                Ø§Ù„Ø´Ø§ØªØ§Øª Ø§Ù„Ù…Ø³Ø¬Ù„Ø©: <strong id="badgeChats">0</strong>
            </div>
        </div>
    </div>

    <!-- ========== GRID LAYOUT ========== -->
    <div class="grid">

        <!-- Ù‚ÙˆØ© Ø§Ù„Ø³ÙˆÙ‚ + Heat Score -->
        <div class="card" id="marketStrengthCard">
            <div class="card-header">
                <div class="card-title">Ù‚ÙˆØ© Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø¹Ø§Ù…Ø© (Market Strength)</div>
                <div class="card-tag">BTCUSDT Snapshot</div>
            </div>
            <div class="card-main" id="strengthValue">...</div>
            <div class="subtext">
                Ù‚Ø±Ø§Ø¡Ø© Ù…Ø¯Ù…Ø¬Ø© Ù„Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ø¨ÙŠØªÙƒÙˆÙŠÙ† ÙˆÙ…Ø¯Ù‰ Ø§Ù„Ø­Ø±ÙƒØ© Ø§Ù„ÙŠÙˆÙ…ÙŠØ© Ø¥Ø¹ØªÙ…Ø§Ø¯Ù‹Ø§ Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Binance / KuCoin ÙÙ‚Ø·ØŒ
                Ø¨Ø¯ÙˆÙ† Ø£Ù‰ Ù…Ø²ÙˆØ¯ Ø¨ÙŠØ§Ù†Ø§Øª Ø®Ø§Ø±Ø¬Ù‰.
            </div>
            <div class="kpi-row">
                <div class="kpi-pill">
                    <span class="kpi-label">Î” Ø§Ù„ÙŠÙˆÙ…:</span>
                    <span class="kpi-val" id="kpiChange">...</span>
                </div>
                <div class="kpi-pill">
                    <span class="kpi-label">Ù…Ø¯Ù‰ Ø§Ù„Ø­Ø±ÙƒØ© %:</span>
                    <span class="kpi-val" id="kpiRange">...</span>
                </div>
                <div class="kpi-pill">
                    <span class="kpi-label">Heat Score:</span>
                    <span class="kpi-val" id="kpiHeat">...</span>
                </div>
            </div>
            <div class="heatbar">
                <div class="heatbar-track"></div>
                <div id="heatDot" class="heatbar-dot" style="left:10%;"></div>
            </div>
            <div class="heatbar-labels">
                <span>Ù‡Ø§Ø¯Ø¦</span>
                <span>Ù†Ø´Ø·</span>
                <span>Ø³Ø§Ø®Ù†</span>
                <span>Ù…Ù†Ø·Ù‚Ø© Ø®Ø·Ø±</span>
            </div>
        </div>

        <!-- Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ù…Ø®Ø§Ø·Ø± -->
        <div class="card" id="riskCard">
            <div class="card-header">
                <div class="card-title">Ù…Ø­Ø±Ùƒ Ø§Ù„Ù…Ø®Ø§Ø·Ø± (IN CRYPTO Ai)</div>
                <div class="card-tag">Risk Engine</div>
            </div>
            <div class="card-main" id="riskValue">...</div>
            <div class="subtext" id="riskNote">...</div>
            <div class="kpi-row">
                <div class="kpi-pill">
                    <span class="kpi-label">Ø¯Ø±Ø¬Ø© Ø§Ù„ØªÙ‚Ù„Ø¨:</span>
                    <span class="kpi-val" id="kpiVol">...</span>
                </div>
                <div class="kpi-pill">
                    <span class="kpi-label">ÙˆØ¶Ø¹ Ø§Ù„Ø³ÙˆÙ‚:</span>
                    <span class="kpi-val" id="kpiMode">...</span>
                </div>
            </div>
        </div>

        <!-- Ù†Ø¨Ø¶ Ø§Ù„Ø³ÙŠÙˆÙ„Ø© -->
        <div class="card">
            <div class="card-header">
                <div class="card-title">Ù†Ø¨Ø¶ Ø§Ù„Ø³ÙŠÙˆÙ„Ø© Ø¨ÙŠÙ† Ø§Ù„Ù…Ø´ØªØ±ÙŠÙ† ÙˆØ§Ù„Ø¨Ø§Ø¦Ø¹ÙŠÙ†</div>
                <div class="card-tag">Liquidity Pulse</div>
            </div>
            <div class="card-main" id="liquidityValue">...</div>
            <div class="subtext">
                ØªØ­Ù„ÙŠÙ„ Ù…Ø¨Ø³Ø· Ù„ØªÙˆØ§Ø²Ù† Ø§Ù„Ø³ÙŠÙˆÙ„Ø© Ø¥Ø¹ØªÙ…Ø§Ø¯Ù‹Ø§ Ø¹Ù„Ù‰ Ø§ØªØ¬Ø§Ù‡ BTCUSDTØŒ Ù„Ù…Ø¹Ø±ÙØ© Ø§Ù„Ø·Ø±Ù Ø§Ù„Ù…Ù‡ÙŠÙ…Ù† Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø±ÙƒØ© Ø­Ø§Ù„ÙŠÙ‹Ø§.
            </div>
            <div class="kpi-row">
                <div class="kpi-pill">
                    <span class="kpi-label">ÙˆØ¶Ø¹ Ø§Ù„Ø³ÙŠÙˆÙ„Ø©:</span>
                    <span class="kpi-val" id="liqLabel">...</span>
                </div>
                <div class="kpi-pill">
                    <span class="kpi-label">Ø¥Ø´Ø§Ø±Ø© Ø§Ù„Ø­Ø±ÙƒØ©:</span>
                    <span class="kpi-val" id="signalPulse">...</span>
                </div>
            </div>
        </div>

        <!-- Ø§Ù„ØªÙ‚Ù„Ø¨ Ø§Ù„ÙŠÙˆÙ…Ù‰ -->
        <div class="card">
            <div class="card-header">
                <div class="card-title">Ù…Ø¤Ø´Ø± Ø§Ù„ØªÙ‚Ù„Ø¨ Ø§Ù„ÙŠÙˆÙ…Ù‰ Ù„Ù„Ø¨ÙŠØªÙƒÙˆÙŠÙ†</div>
                <div class="card-tag">Volatility Monitor</div>
            </div>
            <div class="card-main">
                <span id="volatilityValue">...</span>
                <span class="small">/ 100</span>
            </div>
            <div class="subtext">
                ÙƒÙ„Ù…Ø§ Ø§Ù‚ØªØ±Ø¨ Ø§Ù„Ù…Ø¤Ø´Ø± Ù…Ù† 100 ÙƒØ§Ù† Ø§Ù„Ø³ÙˆÙ‚ Ø£ÙƒØ«Ø± Ø¹Ø¯ÙˆØ§Ù†ÙŠØ© ÙˆÙŠØ­ØªØ§Ø¬ Ø¥Ø¯Ø§Ø±Ø© Ù…Ø®Ø§Ø·Ø± ØµØ§Ø±Ù…Ø©ØŒ
                ÙˆÙƒÙ„Ù…Ø§ Ø§Ù‚ØªØ±Ø¨ Ù…Ù† Ø§Ù„ØµÙØ± ÙƒØ§Ù† Ø§Ù„Ø³ÙˆÙ‚ Ø£ÙƒØ«Ø± Ù‡Ø¯ÙˆØ¡Ù‹Ø§.
            </div>
            <div class="kpi-row">
                <div class="kpi-pill">
                    <span class="kpi-label">Ù†Ø·Ø§Ù‚ Ø§Ù„ÙŠÙˆÙ…:</span>
                    <span class="kpi-val" id="rangeDetail">...</span>
                </div>
                <div class="kpi-pill">
                    <span class="kpi-label">ÙˆØµÙ Ø§Ù„ØªÙ‚Ù„Ø¨:</span>
                    <span class="kpi-val" id="volatilityLabel">...</span>
                </div>
            </div>
        </div>

        <!-- Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ­Ø°ÙŠØ± Ø§Ù„ØªÙ„Ù‚Ø§Ø¦Ù‰ -->
        <div class="card" id="alertFlashCard">
            <div class="card-header">
                <div class="card-title">Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ­Ø°ÙŠØ± Ø§Ù„ØªÙ„Ù‚Ø§Ø¦Ù‰</div>
                <div class="card-tag">/auto_alert</div>
            </div>
            <div class="card-main" id="alertReason">Ù„Ø§ ÙŠÙˆØ¬Ø¯ ØªØ­Ø°ÙŠØ± Ø­Ø§Ù„ÙŠÙ‹Ø§</div>
            <div class="subtext">
                Ø¢Ø®Ø± Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ù„Ù…Ø³Ø§Ø± <code>/auto_alert</code> Ù…Ù† Ø§Ù„Ø¨ÙˆØªØŒ Ù…Ø¹ ÙˆÙ…ÙŠØ¶ ØªÙ„Ù‚Ø§Ø¦Ù‰ Ø¹Ù†Ø¯ Ø¸Ù‡ÙˆØ± Ø³Ø¨Ø¨ ØªØ­Ø°ÙŠØ± Ø¬Ø¯ÙŠØ¯.
            </div>
            <div class="kpi-row">
                <div class="kpi-pill">
                    <span class="kpi-label">Ø¢Ø®Ø± ÙˆÙ‚Øª:</span>
                    <span class="kpi-val" id="alertTime">---</span>
                </div>
                <div class="kpi-pill">
                    <span class="kpi-label">ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ØŸ</span>
                    <span class="kpi-val" id="alertSent">---</span>
                </div>
            </div>
            <div class="btn-row">
                <button class="primary" onclick="callAdmin('force_alert')">Ø¥Ø±Ø³Ø§Ù„ ØªØ­Ø°ÙŠØ± ÙÙˆØ±Ù‰ âš¡</button>
                <button class="secondary" onclick="callAdmin('test_alert')">ØªÙ†Ø¨ÙŠÙ‡ ØªØ¬Ø±ÙŠØ¨Ù‰ ğŸ§ª</button>
            </div>
        </div>

        <!-- Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ ÙˆØ§Ù„Ù„ÙˆØ¬ -->
        <div class="card" id="errorCard">
            <div class="card-header">
                <div class="card-title">Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ ÙˆØ§Ù„Ù„ÙˆØ¬</div>
                <div class="card-tag">Last error + Logs</div>
            </div>
            <div class="card-main" id="lastErrorTitle">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø£Ø®Ø·Ø§Ø¡ Ù…Ø³Ø¬Ù„Ø©</div>
            <div class="subtext">
                ÙŠØªÙ… ØªØ­Ø¯ÙŠØ« Ù‡Ø°Ù‡ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ø¹Ù†Ø¯ ØªØ³Ø¬ÙŠÙ„ Ø£Ù‰ Ø®Ø·Ø£ ÙÙ‰ Ø§Ù„Ø¨ÙˆØªØŒ Ù…Ø¹ Snapshot Ù…Ø¨Ø§Ø´Ø± Ù…Ù† Ø§Ù„Ù„ÙˆØ¬.
            </div>
            <pre id="logsSnapshot">Ø¬Ø§Ø±Ù‰ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù„ÙˆØ¬...</pre>
        </div>

        <!-- Ø³Ø¬Ù„ Ø§Ù„ØªØ­Ø°ÙŠØ±Ø§Øª -->
        <div class="card">
            <div class="card-header">
                <div class="card-title">Ø³Ø¬Ù„ Ø§Ù„ØªØ­Ø°ÙŠØ±Ø§Øª</div>
                <div class="card-tag">Alerts History</div>
            </div>
            <div class="alerts-list" id="alertsList">
                Ø¬Ø§Ø±Ù ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³Ø¬Ù„...
            </div>
            <div class="btn-row">
                <button onclick="reloadAlerts()">ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø³Ø¬Ù„ ğŸ”„</button>
                <button onclick="clearAlerts()">Ù…Ø³Ø­ Ø§Ù„Ø³Ø¬Ù„ ğŸ§¹</button>
            </div>
        </div>

        <!-- ØªØ¯ÙÙ‚ Ø§Ù„Ø£ÙˆØ§Ù…Ø± Ø§Ù„Ù„Ø­Ø¸Ù‰ -->
        <div class="card">
            <div class="card-header">
                <div class="card-title">ØªØ¯ÙÙ‚ Ø§Ù„Ø£ÙˆØ§Ù…Ø± Ø§Ù„Ù„Ø­Ø¸Ù‰ â€” Ø§Ù„Ù…Ø´ØªØ±ÙŠÙ† Ù…Ù‚Ø§Ø¨Ù„ Ø§Ù„Ø¨Ø§Ø¦Ø¹ÙŠÙ†</div>
                <div class="card-tag">Order Flow Snapshot</div>
            </div>
            <div class="card-main" id="orderFlowValue">---</div>
            <div class="subtext" id="orderFlowText">
                ØªÙ‚Ø¯ÙŠØ± ØªÙ‚Ø±ÙŠØ¨Ù‰ Ù„ØªÙˆØ§Ø²Ù† Ø§Ù„Ø¶ØºØ· Ø¨ÙŠÙ† Ø§Ù„Ù…Ø´ØªØ±ÙŠÙ† ÙˆØ§Ù„Ø¨Ø§Ø¦Ø¹ÙŠÙ† Ù…Ù† Ø®Ù„Ø§Ù„ Ø§Ù„ØªØºÙŠÙŠØ± Ø§Ù„ÙŠÙˆÙ…Ù‰ + Ø§Ù„ØªÙ‚Ù„Ø¨ + Ù†Ø¨Ø¶ Ø§Ù„Ø³ÙŠÙˆÙ„Ø©.
            </div>
            <div class="kpi-row">
                <div class="kpi-pill">
                    <span class="kpi-label">Ù‡ÙŠÙ…Ù†Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠÙ†:</span>
                    <span class="kpi-val" id="buyersShare">---</span>
                </div>
                <div class="kpi-pill">
                    <span class="kpi-label">Ù‡ÙŠÙ…Ù†Ø© Ø§Ù„Ø¨Ø§Ø¦Ø¹ÙŠÙ†:</span>
                    <span class="kpi-val" id="sellersShare">---</span>
                </div>
            </div>
        </div>

        <!-- ØªÙˆÙ‚Ø¹ Ù‚ØµÙŠØ± Ø§Ù„Ù…Ø¯Ù‰ -->
        <div class="card">
            <div class="card-header">
                <div class="card-title">ØªÙˆÙ‚Ø¹ Ù‚ØµÙŠØ± Ø§Ù„Ù…Ø¯Ù‰ (â‰ˆ 15â€“30 Ø¯Ù‚ÙŠÙ‚Ø©)</div>
                <div class="card-tag">Short-Term Bias</div>
            </div>
            <div class="card-main" id="shortTermBias">---</div>
            <div class="subtext" id="shortTermText">
                Ø§Ù†Ø­ÙŠØ§Ø² Ø­Ø±ÙƒÙ‰ Ù‚ØµÙŠØ± Ø§Ù„Ù…Ø¯Ù‰ Ù…Ø¨Ù†Ù‰ Ø¹Ù„Ù‰ Ø¯Ù…Ø¬ Ø§Ù„ØªØºÙŠÙŠØ± Ø§Ù„ÙŠÙˆÙ…Ù‰ Ù…Ø¹ Ø¯Ø±Ø¬Ø© Ø§Ù„ØªÙ‚Ù„Ø¨ ÙˆÙ‚ÙˆØ© Ø§Ù„Ø³ÙˆÙ‚.
            </div>
            <div class="kpi-row">
                <div class="kpi-pill">
                    <span class="kpi-label">Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ Ø§Ù„ØµØ¹ÙˆØ¯:</span>
                    <span class="kpi-val" id="upProb">---</span>
                </div>
                <div class="kpi-pill">
                    <span class="kpi-label">Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ Ø§Ù„Ù‡Ø¨ÙˆØ·:</span>
                    <span class="kpi-val" id="downProb">---</span>
                </div>
            </div>
        </div>

        <!-- ÙÙ„ØªØ± Ø§Ù„Ø¶ÙˆØ¶Ø§Ø¡ -->
        <div class="card">
            <div class="card-header">
                <div class="card-title">ÙÙ„ØªØ± Ø§Ù„Ø¶ÙˆØ¶Ø§Ø¡ ÙÙ‰ Ø§Ù„Ø­Ø±ÙƒØ©</div>
                <div class="card-tag">Market Noise Filter</div>
            </div>
            <div class="card-main" id="noiseValue">---</div>
            <div class="subtext" id="noiseText">
                ÙŠÙ‚ÙŠØ³ ÙƒÙ…ÙŠØ© Ø§Ù„Ø­Ø±ÙƒØ© â€œØ§Ù„Ø¹Ø¨Ø«ÙŠØ©â€ Ù…Ù‚Ø§Ø¨Ù„ Ø§Ù„Ø­Ø±ÙƒØ© Ø§Ù„Ù‡Ø§Ø¯ÙØ©Ø› ÙŠØ³Ø§Ø¹Ø¯ ÙÙ‰ Ù…Ø¹Ø±ÙØ© Ù…ØªÙ‰ ÙŠÙØ¶Ù„ Ø§Ù„ØªÙˆÙ‚Ù Ø¹Ù† Ø§Ù„Ù…Ø·Ø§Ø±Ø¯Ø© ÙˆØ§Ù†ØªØ¸Ø§Ø± Ù…Ù†Ø§Ø·Ù‚ Ø£ÙˆØ¶Ø­.
            </div>
            <div class="kpi-row">
                <div class="kpi-pill">
                    <span class="kpi-label">Ø¯Ø±Ø¬Ø© Ø§Ù„Ø¶ÙˆØ¶Ø§Ø¡ Ø§Ù„ØªÙ‚Ø¯ÙŠØ±ÙŠØ©:</span>
                    <span class="kpi-val" id="noiseScore">---</span>
                </div>
            </div>
        </div>

        <!-- ÙˆØ¶Ø¹ Ø§Ù„Ø³ÙƒØ§Ù„Ø¨ÙŠÙ†Ø¬ -->
        <div class="card">
            <div class="card-header">
                <div class="card-title">ÙˆØ¶Ø¹ Ø§Ù„Ø³ÙƒØ§Ù„Ø¨ÙŠÙ†Ø¬ (Scalper Mode)</div>
                <div class="card-tag">Scalper Suitability</div>
            </div>
            <div class="card-main" id="scalpSuitability">---</div>
            <div class="subtext" id="scalpText">
                ØªÙ‚ÙŠÙŠÙ… Ø³Ø±ÙŠØ¹ Ù„Ù…Ù„Ø§Ø¡Ù…Ø© Ø§Ù„Ø¸Ø±ÙˆÙ Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ù„Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ§Øª Ø§Ù„Ø³ÙƒØ§Ù„Ø¨ÙŠÙ†Ø¬ Ø§Ù„Ø³Ø±ÙŠØ¹Ø© (ØªÙ‚Ù„Ø¨ Ã— Ø­Ø±ÙƒØ© Ã— Ø¶ÙˆØ¶Ø§Ø¡).
            </div>
        </div>

        <!-- Ù†Ø¨Ø¶ Ù‡ÙŠÙ…Ù†Ø© Ø§Ù„Ø¨ÙŠØªÙƒÙˆÙŠÙ† -->
        <div class="card">
            <div class="card-header">
                <div class="card-title">Ù†Ø¨Ø¶ Ù‡ÙŠÙ…Ù†Ø© Ø§Ù„Ø¨ÙŠØªÙƒÙˆÙŠÙ† Ø¹Ù„Ù‰ Ø§Ù„Ø³ÙˆÙ‚</div>
                <div class="card-tag">BTC Dominance Pulse (ØªÙ‚Ø¯ÙŠØ±)</div>
            </div>
            <div class="card-main" id="dominanceValue">---</div>
            <div class="subtext" id="dominanceText">
                ØªÙ‚Ø¯ÙŠØ± ØªÙ‚Ø±ÙŠØ¨Ù‰ Ù„Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø³ÙˆÙ‚ Ø­Ø§Ù„ÙŠÙ‹Ø§ ÙŠÙ‚ÙˆØ¯Ù‡ Ø§Ù„Ø¨ÙŠØªÙƒÙˆÙŠÙ†ØŒ Ø£Ù… Ø³ÙˆÙ‚ Ù…Ø®ØªÙ„Ø·ØŒ Ø£Ù… Ø¨ÙŠØ¦Ø© ØªÙ…ÙŠÙ„ Ù„Ù„Ø¹Ù…Ù„Ø§Øª Ø§Ù„Ø¨Ø¯ÙŠÙ„Ø©.
            </div>
        </div>

        <!-- Ø¯Ø±Ø¬Ø© Ø­Ø±Ø§Ø±Ø© Ø§Ù„Ø§ØªØ¬Ø§Ù‡ -->
        <div class="card">
            <div class="card-header">
                <div class="card-title">Ø¯Ø±Ø¬Ø© Ø­Ø±Ø§Ø±Ø© Ø§Ù„Ø§ØªØ¬Ø§Ù‡ (Trend Temperature)</div>
                <div class="card-tag">Momentum Gauge</div>
            </div>
            <div class="card-main" id="trendTempValue">---</div>
            <div class="subtext" id="trendTempText">
                Ù…Ø¤Ø´Ø± Ø¥Ø­Ø³Ø§Ø³ Ø¹Ø§Ù… Ø¨Ø­Ø±Ø§Ø±Ø© Ø§Ù„Ø§ØªØ¬Ø§Ù‡: Ù…Ù† Ø³ÙˆÙ‚ Ù‡Ø§Ø¯Ø¦ ÙˆØ¨Ø·Ù‰Ø¡ Ø¥Ù„Ù‰ Ø³ÙˆÙ‚ Ù…Ø­ØªØ¯Ù… Ø°Ùˆ Ø²Ø®Ù… Ù‚ÙˆÙ‰.
            </div>
        </div>

        <!-- ØªØ¹Ù„ÙŠÙ‚ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹Ù‰ -->
        <div class="card" style="grid-column: span 3;">
            <div class="card-header">
                <div class="card-title">ØªØ¹Ù„ÙŠÙ‚ IN CRYPTO Ai Ø¹Ù„Ù‰ ÙˆØ¶Ø¹ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„ÙŠÙˆÙ…</div>
                <div class="card-tag">AI Market Commentary</div>
            </div>
            <div class="subtext" id="aiComment">
                Ø¬Ø§Ø±Ù ØªØ¬Ù‡ÙŠØ² Ø§Ù„ØªØ¹Ù„ÙŠÙ‚...
            </div>
        </div>

    </div>

    <!-- ========== FOOTER ========== -->
    <div class="footer">
        IN CRYPTO Ai â€” <span>Live Market, Risk & Alert Monitor</span> Ù…Ø¨Ù†Ù‰ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¨ÙŠØªÙƒÙˆÙŠÙ† Ø§Ù„ÙØ¹Ù„ÙŠØ©.
    </div>

    <!-- ========== JAVASCRIPT ========== -->
    <script>
        function getPassParam() {
            const params = new URLSearchParams(window.location.search);
            return params.get("pass") || params.get("password") || "";
        }

        function apiUrl(path) {
            const pass = getPassParam();
            return pass ? path + "?pass=" + encodeURIComponent(pass) : path;
        }

        function computeHeatScore(changePct, volatilityScore, rangePct) {
            let score = Math.abs(changePct) * 1.2 + volatilityScore * 0.7 + rangePct * 0.4;
            if (score > 100) score = 100;
            if (score < 0) score = 0;
            return score;
        }

        function classifyMarketMode(change, volScore, rangePct) {
            if (Math.abs(change) < 0.7 && volScore < 25 && rangePct < 3) {
                return { mode: "NORMAL", label: "Ø­Ø±ÙƒØ© Ù‡Ø§Ø¯Ø¦Ø©" };
            }
            if (Math.abs(change) < 2 && volScore < 45) {
                return { mode: "ACTIVE", label: "Ø³ÙˆÙ‚ Ù†Ø´Ø·" };
            }
            if (volScore > 70 || rangePct > 8) {
                if (change <= -3) return { mode: "PANIC", label: "Ø¶ØºØ· Ø¨ÙŠØ¹Ù‰ Ø¹Ø§Ù„Ù‰" };
                return { mode: "VOLATILE", label: "ØªÙ‚Ù„Ø¨ Ù…Ø±ØªÙØ¹" };
            }
            return { mode: "ACTIVE", label: "Ø³ÙˆÙ‚ Ù†Ø´Ø·" };
        }

        function classifyVolatility(volScore) {
            if (volScore < 20) return "Ù…Ù†Ø®ÙØ¶";
            if (volScore < 45) return "Ù…ØªÙˆØ³Ø·";
            if (volScore < 70) return "Ù…Ø±ØªÙØ¹";
            return "Ø­Ø§Ø¯ Ø¬Ø¯Ù‹Ø§";
        }

        function buildSignalPulse(change, volScore) {
            if (Math.abs(change) < 0.5 && volScore > 55) {
                return "âš ï¸ Ø¶ØºØ· Ø¹Ø§Ù„Ù‰ Ø¨Ø¯ÙˆÙ† Ø­Ø±ÙƒØ© ÙˆØ§Ø¶Ø­Ø© â†’ Ø§Ø­ØªÙ…Ø§Ù„ Ø§Ù†ÙØ¬Ø§Ø± Ø³Ø¹Ø±Ù‰ Ù‚Ø±ÙŠØ¨.";
            }
            if (change > 2.5 && volScore > 50) {
                return "â¬†ï¸ Ø­Ø±ÙƒØ© ØµØ¹ÙˆØ¯ Ù‚ÙˆÙŠØ© Ù…Ø¹ Ø²Ø®Ù… ÙˆØ§Ø¶Ø­ Ù„ØµØ§Ù„Ø­ Ø§Ù„Ù…Ø´ØªØ±ÙŠÙ†.";
            }
            if (change < -2.5 && volScore > 50) {
                return "â¬‡ï¸ Ø­Ø±ÙƒØ© Ù‡Ø¨ÙˆØ· Ù‚ÙˆÙŠØ© Ù…Ø¹ Ø¶ØºØ· Ø¨ÙŠØ¹Ù‰ ÙˆØ§Ø¶Ø­.";
            }
            if (volScore < 20) {
                return "ğŸ˜´ Ø³ÙˆÙ‚ Ù‡Ø§Ø¯Ø¦ Ù†Ø³Ø¨ÙŠÙ‹Ø§ Ø¨Ø¯ÙˆÙ† Ø­Ø±ÙƒØ© ÙƒØ¨ÙŠØ±Ø©.";
            }
            return "ğŸ” ØªØ°Ø¨Ø°Ø¨ Ø·Ø¨ÙŠØ¹Ù‰ Ù…Ø¹ Ø³ÙŠÙˆÙ„Ø© Ù…ØªÙˆØ§Ø²Ù†Ø© ØªÙ‚Ø±ÙŠØ¨Ù‹Ø§.";
        }

        function estimateOrderFlow(change, volScore, liquidityLabel) {
            let base = 50;
            base += change * 2;
            base += (liquidityLabel.includes("Ø§Ù„Ù…Ø´ØªØ±ÙŠÙ†") ? 5 : 0);
            base -= (liquidityLabel.includes("Ø§Ù„Ø¨Ø§Ø¦Ø¹ÙŠÙ†") ? 5 : 0);
            base = Math.max(0, Math.min(100, base));

            const buyers = base;
            const sellers = 100 - base;

            let label;
            if (buyers > 60) label = "Ù‡ÙŠÙ…Ù†Ø© ÙˆØ§Ø¶Ø­Ø© Ù„Ù„Ù…Ø´ØªØ±ÙŠÙ†";
            else if (sellers > 60) label = "Ù‡ÙŠÙ…Ù†Ø© ÙˆØ§Ø¶Ø­Ø© Ù„Ù„Ø¨Ø§Ø¦Ø¹ÙŠÙ†";
            else label = "ØªÙˆØ§Ø²Ù† Ù†Ø³Ø¨Ù‰ Ø¨ÙŠÙ† Ø§Ù„Ù…Ø´ØªØ±ÙŠÙ† ÙˆØ§Ù„Ø¨Ø§Ø¦Ø¹ÙŠÙ†";

            return { buyers, sellers, label };
        }

        function estimateShortTermBias(change, volScore, strengthLabel) {
            const absChange = Math.abs(change);
            let up = 50, down = 50;
            if (change > 0) {
                up += absChange * 3;
                if (strengthLabel.includes("ØµØ¹ÙˆØ¯") || strengthLabel.includes("Ø¥ÙŠØ¬Ø§Ø¨Ù‰")) up += 7;
            } else if (change < 0) {
                down += absChange * 3;
                if (strengthLabel.includes("Ù‡Ø¨ÙˆØ·") || strengthLabel.includes("Ø³Ù„Ø¨Ù‰")) down += 7;
            }
            if (volScore > 65) {
                up *= 1.05;
                down *= 1.05;
            }
            const sum = up + down;
            up = Math.round((up / sum) * 100);
            down = 100 - up;

            let biasText;
            if (up - down > 15) biasText = "Ù…ÙŠÙ„ Ù‚ØµÙŠØ± Ø§Ù„Ù…Ø¯Ù‰ Ù„ØµØ§Ù„Ø­ Ø§Ù„ØµØ¹ÙˆØ¯";
            else if (down - up > 15) biasText = "Ù…ÙŠÙ„ Ù‚ØµÙŠØ± Ø§Ù„Ù…Ø¯Ù‰ Ù„ØµØ§Ù„Ø­ Ø§Ù„Ù‡Ø¨ÙˆØ·";
            else biasText = "ØªØ°Ø¨Ø°Ø¨ Ù‚ØµÙŠØ± Ø§Ù„Ù…Ø¯Ù‰ Ø¨Ø¯ÙˆÙ† Ø§Ù†Ø­ÙŠØ§Ø² ÙˆØ§Ø¶Ø­";

            return { up, down, biasText };
        }

        function estimateNoise(change, volScore, rangePct) {
            const absChange = Math.abs(change);
            let noise = volScore * 0.6 + rangePct * 0.5 - absChange * 1.2;
            if (noise < 0) noise = 0;
            if (noise > 100) noise = 100;

            let label;
            if (noise < 25) label = "Ø§Ù„Ø¶ÙˆØ¶Ø§Ø¡ Ù…Ù†Ø®ÙØ¶Ø©Ø› Ø§Ù„Ø­Ø±ÙƒØ© ÙˆØ§Ø¶Ø­Ø© Ù†Ø³Ø¨ÙŠÙ‹Ø§.";
            else if (noise < 55) label = "Ø¶ÙˆØ¶Ø§Ø¡ Ù…ØªÙˆØ³Ø·Ø©Ø› ÙŠÙØ¶Ù„ Ø§Ù†ØªØ¸Ø§Ø± ØªØ£ÙƒÙŠØ¯ Ù‚Ø¨Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„.";
            else label = "Ø¶ÙˆØ¶Ø§Ø¡ Ø¹Ø§Ù„ÙŠØ© Ø¬Ø¯Ù‹Ø§Ø› Ø§Ù„Ø£ÙØ¶Ù„ ØªØ¬Ù†Ø¨ Ø§Ù„Ù…Ø·Ø§Ø±Ø¯Ø© ÙˆØ§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨Ø§Ù„Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„Ù‚ÙˆÙŠØ© ÙÙ‚Ø·.";

            return { noise: Math.round(noise), label };
        }

        function estimateScalperSuitability(volScore, noiseScore, rangePct) {
            let score = volScore * 0.7 + rangePct * 2 - noiseScore * 0.5;
            if (score < 0) score = 0;
            if (score > 100) score = 100;

            let label;
            if (score < 35) label = "ğŸ˜´ ØºÙŠØ± Ù…Ù†Ø§Ø³Ø¨ Ù„Ù„Ø³ÙƒØ§Ù„Ø¨ÙŠÙ†Ø¬ â€” Ø§Ù„Ø³ÙˆÙ‚ Ù‡Ø§Ø¯Ø¦ Ø£Ùˆ Ø¶ÙˆØ¶Ø§Ø¦Ù‰ Ø£ÙƒØ«Ø± Ù…Ù† Ø§Ù„Ù„Ø§Ø²Ù….";
            else if (score < 70) label = "âš–ï¸ Ù…Ù†Ø§Ø³Ø¨ Ø¬Ø²Ø¦ÙŠÙ‹Ø§ Ù…Ø¹ Ø§Ù†ØªÙ‚Ø§Ø¡ Ø§Ù„ÙØ±ØµØŒ ÙˆÙŠÙØ¶Ù„ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨Ù…Ù†Ø§Ø·Ù‚ ÙˆØ§Ø¶Ø­Ø©.";
            else label = "âš¡ Ø¨ÙŠØ¦Ø© Ù†Ø´Ø·Ø© Ø¬Ø¯Ù‹Ø§ â€” Ù…Ù†Ø§Ø³Ø¨Ø© Ù„Ù„Ø³ÙƒØ§Ù„Ø¨ÙŠÙ†Ø¬ Ù…Ø¹ Ø§Ù†Ø¶Ø¨Ø§Ø· Ù‚ÙˆÙ‰ ÙÙ‰ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø®Ø§Ø·Ø±.";

            return { score: Math.round(score), label };
        }

        function estimateDominance(change, liquidityLabel) {
            let label, text;
            if (Math.abs(change) < 0.8) {
                label = "Mixed Market / Ø³ÙˆÙ‚ Ù…Ø®ØªÙ„Ø·";
                text = "Ø§Ù„Ø­Ø±ÙƒØ© Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ù„Ø§ ØªÙØ¸Ù‡Ø± Ù‡ÙŠÙ…Ù†Ø© Ø­Ø§Ø¯Ø© Ù„Ù„Ø¨ÙŠØªÙƒÙˆÙŠÙ†Ø› Ø§Ù„Ø³ÙˆÙ‚ ÙŠÙ…ÙŠÙ„ Ù„Ø£Ù† ÙŠÙƒÙˆÙ† Ù…Ø®ØªÙ„Ø·Ù‹Ø§ Ø¨ÙŠÙ† Ø§Ù„Ø¨ÙŠØªÙƒÙˆÙŠÙ† ÙˆØ§Ù„Ø¹Ù…Ù„Ø§Øª Ø§Ù„Ø¨Ø¯ÙŠÙ„Ø©.";
            } else if (change > 0 && liquidityLabel.includes("Ø§Ù„Ù…Ø´ØªØ±ÙŠÙ†")) {
                label = "BTC-Led / Ù‡ÙŠÙ…Ù†Ø© Ù„Ù„Ø¨ÙŠØªÙƒÙˆÙŠÙ†";
                text = "ØµØ¹ÙˆØ¯ Ø§Ù„Ø¨ÙŠØªÙƒÙˆÙŠÙ† Ù…Ø¹ Ù…ÙŠÙ„ Ø§Ù„Ø³ÙŠÙˆÙ„Ø© Ù„ØµØ§Ù„Ø­ Ø§Ù„Ù…Ø´ØªØ±ÙŠÙ† ÙŠØ´ÙŠØ± Ø¥Ù„Ù‰ Ø£Ù† Ø§Ù„Ø¨ÙŠØªÙƒÙˆÙŠÙ† ÙŠÙ‚ÙˆØ¯ Ø§Ù„Ù…Ø´Ù‡Ø¯ Ø§Ù„Ø­Ø§Ù„Ù‰ Ø¹Ù„Ù‰ Ø­Ø³Ø§Ø¨ Ø£ØºÙ„Ø¨ Ø§Ù„Ø¹Ù…Ù„Ø§Øª.";
            } else if (change < 0 && liquidityLabel.includes("Ø§Ù„Ø¨Ø§Ø¦Ø¹ÙŠÙ†")) {
                label = "BTC Risk-Off / Ø®Ø±ÙˆØ¬ Ù…Ù† Ø§Ù„Ù…Ø®Ø§Ø·Ø±";
                text = "Ø¶ØºØ· Ø¨ÙŠØ¹Ù‰ Ø¹Ù„Ù‰ Ø§Ù„Ø¨ÙŠØªÙƒÙˆÙŠÙ† Ù…Ø¹ Ù…ÙŠÙ„ Ø§Ù„Ø³ÙŠÙˆÙ„Ø© Ù„ØµØ§Ù„Ø­ Ø§Ù„Ø¨Ø§Ø¦Ø¹ÙŠÙ†Ø› Ø¹Ø§Ø¯Ø©Ù‹ Ù…Ø§ ÙŠÙƒÙˆÙ† Ù‡Ø°Ø§ Ù†Ù…Ø· Ø®Ø±ÙˆØ¬ Ø¹Ø§Ù… Ù…Ù† Ø§Ù„Ù…Ø®Ø§Ø·Ø±.";
            } else {
                label = "Alt-Friendly / Ø¨ÙŠØ¦Ø© ØªÙ…ÙŠÙ„ Ù„Ù„Ø¹Ù…Ù„Ø§Øª Ø§Ù„Ø¨Ø¯ÙŠÙ„Ø©";
                text = "Ø­Ø±ÙƒØ© Ø§Ù„Ø¨ÙŠØªÙƒÙˆÙŠÙ† Ø£Ù‚Ù„ Ø­Ø¯Ø© Ù†Ø³Ø¨ÙŠÙ‹Ø§ØŒ Ù…Ø§ ÙŠÙØªØ­ Ø§Ù„Ù…Ø¬Ø§Ù„ Ù„ÙØ±Øµ Ù…ØªÙØ±Ù‚Ø© ÙÙ‰ Ø¨Ø¹Ø¶ Ø§Ù„Ø¹Ù…Ù„Ø§Øª Ø§Ù„Ø¨Ø¯ÙŠÙ„Ø© (Ù…Ø¹ Ø¨Ù‚Ø§Ø¡ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø®Ø§Ø·Ø± Ø£Ø³Ø§Ø³ÙŠØ©).";
            }
            return { label, text };
        }

        function estimateTrendTemp(change, volScore) {
            const absChange = Math.abs(change);
            let temp = absChange * 6 + volScore * 0.8;
            if (temp > 100) temp = 100;

            let label;
            if (temp < 25) label = "â„ï¸ Ø§ØªØ¬Ø§Ù‡ Ø¨Ø§Ø±Ø¯ â€” Ø§Ù„Ø³ÙˆÙ‚ ÙŠØªØ­Ø±Ùƒ Ø¨Ø¨Ø·Ø¡ Ø¨Ø¯ÙˆÙ† Ø²Ø®Ù… ÙˆØ§Ø¶Ø­.";
            else if (temp < 55) label = "ğŸŒ¤ Ø§ØªØ¬Ø§Ù‡ Ù…Ø¹ØªØ¯Ù„ â€” Ø­Ø±ÙƒØ© Ù…Ø¹Ù‚ÙˆÙ„Ø© Ù…Ø¹ Ø²Ø®Ù… Ù‚Ø§Ø¨Ù„ Ù„Ù„Ù…ØªØ§Ø¨Ø¹Ø©.";
            else if (temp < 80) label = "ğŸ”¥ Ø§ØªØ¬Ø§Ù‡ Ø³Ø§Ø®Ù† â€” Ø­Ø±ÙƒØ© Ù‚ÙˆÙŠØ© ØªØ³ØªØ­Ù‚ Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ù…Ø¹ Ø¥Ø¯Ø§Ø±Ø© Ù…Ø®Ø§Ø·Ø± Ù…Ø´Ø¯Ø¯Ø©.";
            else label = "â˜„ï¸ Ø§ØªØ¬Ø§Ù‡ Ù…Ø´ØªØ¹ÙÙ„ â€” Ø²Ø®Ù… Ø¹Ø§Ù„Ù‰ Ø¬Ø¯Ù‹Ø§ ÙˆØ§Ø­ØªÙ…Ø§Ù„ Ø­Ø±ÙƒØ§Øª Ø¹Ù†ÙŠÙØ© ÙÙ‰ Ø£Ù‰ Ù„Ø­Ø¸Ø©.";

            return { temp: Math.round(temp), label };
        }

        function buildAIComment(change, volScore, riskMsg, liquidityPulse, strengthLabel, modeInfo) {
            const dirText =
                change > 0.7 ? "Ø§Ù„Ø³ÙˆÙ‚ ÙŠÙ…ÙŠÙ„ Ø­Ø§Ù„ÙŠÙ‹Ø§ Ù„ØµØ§Ù„Ø­ Ø§Ù„Ù…Ø´ØªØ±ÙŠÙ† Ù…Ø¹ ØµØ¹ÙˆØ¯ Ù…Ù„Ø­ÙˆØ¸ ÙÙ‰ Ø§Ù„Ø¨ÙŠØªÙƒÙˆÙŠÙ†." :
                change < -0.7 ? "Ø§Ù„Ø³ÙˆÙ‚ ÙŠÙ…ÙŠÙ„ Ø­Ø§Ù„ÙŠÙ‹Ø§ Ù„ØµØ§Ù„Ø­ Ø§Ù„Ø¨Ø§Ø¦Ø¹ÙŠÙ† Ù…Ø¹ Ø¶ØºØ· Ø¨ÙŠØ¹Ù‰ ÙˆØ§Ø¶Ø­ Ø¹Ù„Ù‰ Ø§Ù„Ø¨ÙŠØªÙƒÙˆÙŠÙ†." :
                "Ø§Ù„Ø³ÙˆÙ‚ ÙŠØªØ­Ø±Ùƒ Ø¨ØªØ°Ø¨Ø°Ø¨ Ù…Ø­Ø¯ÙˆØ¯ Ù†Ø³Ø¨ÙŠÙ‹Ø§ Ø¨Ø¯ÙˆÙ† Ø§ØªØ¬Ø§Ù‡ Ø­Ø§Ø³Ù… Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†.";

            const volText =
                volScore < 25 ? "Ø¯Ø±Ø¬Ø© Ø§Ù„ØªÙ‚Ù„Ø¨ Ù…Ø§ Ø²Ø§Ù„Øª Ù‡Ø§Ø¯Ø¦Ø© Ù†Ø³Ø¨ÙŠÙ‹Ø§ØŒ Ù…Ø§ ÙŠØ¹Ø·Ù‰ Ù…Ø³Ø§Ø­Ø© Ø£ÙØ¶Ù„ Ù„Ù„ØªØ®Ø·ÙŠØ· Ù‚Ø¨Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„." :
                volScore < 55 ? "Ø§Ù„ØªÙ‚Ù„Ø¨ ÙÙ‰ Ø§Ù„Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù…ØªÙˆØ³Ø·Ø©ØŒ Ø§Ù„Ø­Ø±ÙƒØ© Ù„ÙŠØ³Øª Ø¹Ù†ÙŠÙØ© Ù„ÙƒÙ† Ù„ÙŠØ³Øª Ù‡Ø§Ø¯Ø¦Ø© ØªÙ…Ø§Ù…Ù‹Ø§." :
                "Ø§Ù„ØªÙ‚Ù„Ø¨ Ù…Ø±ØªÙØ¹ Ø­Ø§Ù„ÙŠÙ‹Ø§Ø› Ø£Ù‰ Ù‚Ø±Ø§Ø± Ø¯Ø®ÙˆÙ„ Ø¨Ø¯ÙˆÙ† Ø®Ø·Ø© ØµØ§Ø±Ù…Ø© Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø®Ø§Ø·Ø± Ù‚Ø¯ ÙŠÙƒÙˆÙ† Ù…ÙƒÙ„ÙÙ‹Ø§.";

            const riskText = `Ù‚Ø±Ø§Ø¡Ø© Ù…Ø­Ø±Ùƒ Ø§Ù„Ù…Ø®Ø§Ø·Ø±: ${riskMsg || "Ù„Ù… ÙŠØªÙ… ØªØ­Ø¯ÙŠØ¯ Ø±Ø³Ø§Ù„Ø© Ù…ÙØµÙ„Ø©."}`;

            const liqText =
                liquidityPulse && liquidityPulse.indexOf("Ù…ØªÙˆØ§Ø²Ù†Ø©") !== -1
                    ? "Ù†Ø¨Ø¶ Ø§Ù„Ø³ÙŠÙˆÙ„Ø© ÙŠØ´ÙŠØ± Ø¥Ù„Ù‰ ØªÙˆØ§Ø²Ù† ØªÙ‚Ø±ÙŠØ¨Ù‰ Ø¨ÙŠÙ† Ø§Ù„Ù…Ø´ØªØ±ÙŠÙ† ÙˆØ§Ù„Ø¨Ø§Ø¦Ø¹ÙŠÙ†."
                    : `Ù†Ø¨Ø¶ Ø§Ù„Ø³ÙŠÙˆÙ„Ø© Ø§Ù„Ø­Ø§Ù„Ù‰: ${liquidityPulse || "ØºÙŠØ± Ù…ØªÙˆÙØ±"}.`;

            const modeText = `ØªØµÙ†ÙŠÙ Ù†Ù…Ø· Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø­Ø§Ù„Ù‰: <b>${modeInfo.mode}</b> â€” ${modeInfo.label}.`;

            return (
                dirText + " " +
                volText + " " +
                riskText + " " +
                liqText + " " +
                modeText +
                " Ù‡Ø°Ù‡ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© ØªØ¹Ù„ÙŠÙ…ÙŠØ© ÙˆÙ„ÙŠØ³Øª ØªÙˆØµÙŠØ© Ù…Ø¨Ø§Ø´Ø±Ø© Ø¨Ø§Ù„Ø´Ø±Ø§Ø¡ Ø£Ùˆ Ø§Ù„Ø¨ÙŠØ¹."
            );
        }

        async function loadMain() {
            try {
                const res = await fetch(apiUrl("/dashboard_api"));
                const data = await res.json();
                if (!data.ok) return;

                const price = data.price;
                const change = data.change_pct;
                const rangePct = data.range_pct;
                const volScore = data.volatility_score;
                const riskLevel = data.risk_level;
                const riskEmoji = data.risk_emoji;
                const riskMsg = data.risk_message;
                const liquidityPulse = data.liquidity_pulse;
                const strengthLabel = data.strength_label;

                // Header badges
                document.getElementById("badgeChats").textContent = data.known_chats ?? 0;
                document.getElementById("badgeRealtime").textContent = data.last_realtime_tick || "Ù„Ø§ ÙŠÙˆØ¬Ø¯";

                // Top ticker
                const barPrice = document.getElementById("barPrice");
                const barChange = document.getElementById("barChange");
                const barRange = document.getElementById("barRange");

                const changeClass = change >= 0 ? "up" : "down";

                barPrice.textContent = price.toLocaleString();
                barChange.innerHTML = `<span class="${changeClass}">${change >= 0 ? "+" : ""}${change.toFixed(2)}%</span>`;
                barRange.textContent = rangePct.toFixed(2) + "%";

                const modeInfo = classifyMarketMode(change, volScore, rangePct);
                document.getElementById("badgeMode").textContent = modeInfo.mode;

                // Market Strength
                document.getElementById("strengthValue").textContent = strengthLabel;
                document.getElementById("kpiChange").textContent =
                    (change >= 0 ? "+" : "") + change.toFixed(2) + "%";
                document.getElementById("kpiRange").textContent = rangePct.toFixed(2) + "%";

                const heatScore = computeHeatScore(change, volScore, rangePct);
                document.getElementById("kpiHeat").textContent = heatScore.toFixed(0) + " / 100";
                const heatDot = document.getElementById("heatDot");
                heatDot.style.left = Math.min(96, Math.max(4, heatScore)) + "%";

                // Risk card
                const riskCard = document.getElementById("riskCard");
                document.getElementById("riskValue").innerHTML = riskEmoji + " " + riskLevel;
                document.getElementById("riskNote").textContent = riskMsg;
                document.getElementById("kpiVol").textContent = volScore.toFixed(1) + " / 100";
                document.getElementById("kpiMode").textContent = modeInfo.label;

                riskCard.classList.remove("green", "yellow", "red");
                if (riskLevel.includes("Ù…Ù†Ø®ÙØ¶")) riskCard.classList.add("green");
                else if (riskLevel.includes("Ù…ØªÙˆØ³Ø·")) riskCard.classList.add("yellow");
                else riskCard.classList.add("red");

                // Liquidity
                document.getElementById("liquidityValue").textContent = liquidityPulse;
                const liqLabel =
                    change > 0 ? "Ù…ÙŠÙ„ Ù„ØµØ§Ù„Ø­ Ø§Ù„Ù…Ø´ØªØ±ÙŠÙ†" :
                    change < 0 ? "Ù…ÙŠÙ„ Ù„ØµØ§Ù„Ø­ Ø§Ù„Ø¨Ø§Ø¦Ø¹ÙŠÙ†" :
                    "Ù…ØªÙˆØ§Ø²Ù†Ø© ØªÙ‚Ø±ÙŠØ¨Ù‹Ø§";
                document.getElementById("liqLabel").textContent = liqLabel;
                document.getElementById("signalPulse").textContent =
                    buildSignalPulse(change, volScore);

                // Volatility
                document.getElementById("volatilityValue").textContent = volScore.toFixed(1);
                document.getElementById("rangeDetail").textContent = rangePct.toFixed(2) + "%";
                document.getElementById("volatilityLabel").textContent =
                    classifyVolatility(volScore);

                // Last error (title only)
                const lastErr = data.last_error || {};
                const errTitle = document.getElementById("lastErrorTitle");
                const errCard = document.getElementById("errorCard");

                if (lastErr && lastErr.message) {
                    errTitle.textContent = "Ø¢Ø®Ø± Ø®Ø·Ø£ â€” " + (lastErr.time || "");
                    errCard.classList.add("yellow");
                } else {
                    errTitle.textContent = "Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø£Ø®Ø·Ø§Ø¡ Ù…Ø³Ø¬Ù„Ø©";
                    errCard.classList.remove("yellow");
                }

                // Auto alert
                const aa = data.last_auto_alert || {};
                const alertCard = document.getElementById("alertFlashCard");
                document.getElementById("alertReason").textContent =
                    aa.reason || "Ù„Ø§ ÙŠÙˆØ¬Ø¯ ØªØ­Ø°ÙŠØ± Ø­Ø§Ù„ÙŠÙ‹Ø§";
                document.getElementById("alertTime").textContent = aa.time || "---";
                document.getElementById("alertSent").textContent =
                    aa.sent === true ? "Ù†Ø¹Ù… âœ…" :
                    aa.sent === false ? "Ù„Ø§ âŒ" : "---";

                if (aa.reason && aa.reason !== "no_alert" && aa.reason !== "duplicate") {
                    alertCard.classList.add("flash");
                } else {
                    alertCard.classList.remove("flash");
                }

                // Order flow
                const of = estimateOrderFlow(change, volScore, liqLabel);
                document.getElementById("orderFlowValue").textContent = of.label;
                document.getElementById("buyersShare").textContent = of.buyers.toFixed(0) + "Ùª";
                document.getElementById("sellersShare").textContent = of.sellers.toFixed(0) + "Ùª";

                // Short term bias
                const st = estimateShortTermBias(change, volScore, strengthLabel);
                document.getElementById("shortTermBias").textContent = st.biasText;
                document.getElementById("upProb").textContent = st.up + "Ùª";
                document.getElementById("downProb").textContent = st.down + "Ùª";

                // Noise
                const nf = estimateNoise(change, volScore, rangePct);
                document.getElementById("noiseValue").textContent = nf.noise + " / 100";
                document.getElementById("noiseScore").textContent = nf.noise + " / 100";
                document.getElementById("noiseText").textContent = nf.label;

                // Scalper mode
                const sc = estimateScalperSuitability(volScore, nf.noise, rangePct);
                document.getElementById("scalpSuitability").textContent =
                    sc.score + " / 100";
                document.getElementById("scalpText").textContent = sc.label;

                // Dominance
                const dom = estimateDominance(change, liqLabel);
                document.getElementById("dominanceValue").textContent = dom.label;
                document.getElementById("dominanceText").textContent = dom.text;

                // Trend temperature
                const tt = estimateTrendTemp(change, volScore);
                document.getElementById("trendTempValue").textContent =
                    tt.temp + " / 100";
                document.getElementById("trendTempText").textContent = tt.label;

                // AI comment
                const comment = buildAIComment(
                    change,
                    volScore,
                    riskMsg,
                    liquidityPulse,
                    strengthLabel,
                    modeInfo
                );
                document.getElementById("aiComment").innerHTML = comment;

            } catch (e) {
                console.log("Dashboard Error:", e);
            }
        }

        async function loadLogs() {
            try {
                const res = await fetch(apiUrl("/admin/logs"));
                if (!res.ok) return;
                const txt = await res.text();
                document.getElementById("logsSnapshot").textContent =
                    txt || "Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù„ÙˆØ¬Ø§Øª Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†.";
            } catch (e) {
                console.log("Logs error:", e);
            }
        }

        async function reloadAlerts() {
            try {
                const res = await fetch(apiUrl("/admin/alerts_history"));
                const data = await res.json();
                const container = document.getElementById("alertsList");

                if (!data.ok) {
                    container.textContent = "Ù„Ø§ ÙŠÙ…ÙƒÙ† ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³Ø¬Ù„ Ø§Ù„Ø¢Ù†.";
                    return;
                }

                const list = data.alerts || [];
                if (!list.length) {
                    container.textContent = "Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØ­Ø°ÙŠØ±Ø§Øª Ù…Ø³Ø¬Ù„Ø© Ø¨Ø¹Ø¯.";
                    return;
                }

                const items = list.slice().reverse().map(a => {
                    const changeStr = a.change_pct != null
                        ? ` (Î” ${a.change_pct.toFixed(2)}Ùª)`
                        : "";
                    return `
                        <div class="alert-item">
                            â€¢ [${a.time || "?"}] ${a.source || "?"} â€” ${a.reason || ""}${changeStr}
                        </div>
                    `;
                }).join("");

                container.innerHTML = items;
            } catch (e) {
                console.log("Alerts error:", e);
            }
        }

        async function clearAlerts() {
            if (!confirm("Ù…ØªØ£ÙƒØ¯ Ø¥Ù†Ùƒ Ø¹Ø§ÙŠØ² ØªÙ…Ø³Ø­ Ø³Ø¬Ù„ Ø§Ù„ØªØ­Ø°ÙŠØ±Ø§Øª Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ØŸ")) return;
            try {
                const res = await fetch(apiUrl("/admin/clear_alerts"));
                const data = await res.json();
                alert(data.message || "ØªÙ….");
                reloadAlerts();
            } catch (e) {
                console.log("clearAlerts error:", e);
            }
        }

        async function callAdmin(action) {
            try {
                const res = await fetch(apiUrl("/admin/" + action));
                const data = await res.json();
                alert(data.message || JSON.stringify(data));
            } catch (e) {
                console.log("admin action error:", e);
            }
        }

        // Ø£ÙˆÙ„ ØªØ´ØºÙŠÙ„
        loadMain();
        loadLogs();
        reloadAlerts();

        // ØªØ­Ø¯ÙŠØ«Ø§Øª Ø¯ÙˆØ±ÙŠØ©
        setInterval(loadMain, 10000);      // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø³ÙˆÙ‚
        setInterval(loadLogs, 30000);      // Snapshot Ø§Ù„Ù„ÙˆØ¬
        setInterval(reloadAlerts, 60000);  // Ø³Ø¬Ù„ Ø§Ù„ØªØ­Ø°ÙŠØ±Ø§Øª
    </script>
</body>
</html>
```î¨0î¨‚
